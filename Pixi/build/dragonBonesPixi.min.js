var __extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},dragonBones;!function(t){var e=function(e){function r(){e.call(this),r._clock||(r._clock=new t.WorldClock,PIXI.ticker.shared.add(r._clockHandler,r))}return __extends(r,e),r._clockHandler=function(t){r._clock.advanceTime(-1)},r.prototype._onClear=function(){this._armature=null,this._debugDrawer&&(this._debugDrawer.destroy(!0),this._debugDrawer=null),this.destroy(!0)},r.prototype._dispatchEvent=function(t){this.emit(t.type,t)},r.prototype._debugDraw=function(){this._debugDrawer||(this._debugDrawer=new PIXI.Graphics),this.addChild(this._debugDrawer),this._debugDrawer.clear();for(var t=this._armature.getBones(),e=0,r=t.length;e<r;++e){var i=t[e],a=Math.max(i.length,5),n=i.globalTransformMatrix.tx,s=i.globalTransformMatrix.ty,o=n+i.globalTransformMatrix.a*a,l=s+i.globalTransformMatrix.b*a;this._debugDrawer.lineStyle(1,i.ik?16711680:65280,.5),this._debugDrawer.moveTo(n,s),this._debugDrawer.lineTo(o,l)}},r.prototype.hasEvent=function(t){return this.listeners(t,!0)},r.prototype.addEvent=function(t,e,r){this.addListener(t,e,r)},r.prototype.removeEvent=function(t,e,r){this.removeListener(t,e,r)},r.prototype.advanceTimeBySelf=function(t){t?r._clock.add(this._armature):r._clock.remove(this._armature)},r.prototype.dispose=function(){this._armature&&(this.advanceTimeBySelf(!1),this._armature.dispose(),this._armature=null)},Object.defineProperty(r.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"animation",{get:function(){return this._armature.animation},enumerable:!0,configurable:!0}),r._clock=null,r}(PIXI.Container);t.PixiArmatureDisplay=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function r(r){void 0===r&&(r=null),e.call(this,r),t.EventObject._soundEventManager||(t.EventObject._soundEventManager=new t.PixiArmatureDisplay)}return __extends(r,e),Object.defineProperty(r,"factory",{get:function(){return r._factory||(r._factory=new r),r._factory},enumerable:!0,configurable:!0}),r.prototype._generateTextureAtlasData=function(e,r){return e?e.texture=r:e=t.BaseObject.borrowObject(t.PixiTextureAtlasData),e},r.prototype._generateArmature=function(e){var r=t.BaseObject.borrowObject(t.Armature),i=new t.PixiArmatureDisplay;return r._armatureData=e.armature,r._skinData=e.skin,r._animation=t.BaseObject.borrowObject(t.Animation),r._display=i,i._armature=r,r._animation._armature=r,r.animation.animations=e.armature.animations,r},r.prototype._generateSlot=function(e,r){var i=t.BaseObject.borrowObject(t.PixiSlot),a=r.slot,n=[];i.name=a.name,i._rawDisplay=new PIXI.Sprite;for(var s=0,o=r.displays.length;s<o;++s){var l=r.displays[s];switch(l.type){case 0:l.texture||(l.texture=this._getTextureData(e.dataName,l.name)),n.push(i._rawDisplay);break;case 2:l.texture||(l.texture=this._getTextureData(e.dataName,l.name)),i._meshDisplay||(i._meshDisplay=new PIXI.mesh.Mesh(null,null,null,null,PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES)),n.push(i._meshDisplay);break;case 1:var u=this.buildArmature(l.name,e.dataName);if(u){if(!i.inheritAnimation){var h=a.actions.length>0?a.actions:u.armatureData.actions;if(h.length>0)for(var p=0,_=h.length;p<_;++p)u._bufferAction(h[p]);else u.animation.play()}l.armature=u.armatureData}n.push(u);break;default:n.push(null)}}return i._setDisplayList(n),i},r.prototype.buildArmatureDisplay=function(t,e,r){void 0===e&&(e=null),void 0===r&&(r=null);var i=this.buildArmature(t,e,r),a=i?i._display:null;return a&&a.advanceTimeBySelf(!0),a},r.prototype.getTextureDisplay=function(t,e){void 0===e&&(e=null);var r=this._getTextureData(e,t);return r?new PIXI.Sprite(r.texture):null},Object.defineProperty(r.prototype,"soundEventManater",{get:function(){return t.EventObject._soundEventManager},enumerable:!0,configurable:!0}),r._factory=null,r}(t.BaseFactory);t.PixiFactory=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){t.call(this)}return __extends(e,t),e.toString=function(){return"[class dragonBones.PixiSlot]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this._renderDisplay=null},e.prototype._onUpdateDisplay=function(){this._rawDisplay||(this._rawDisplay=new PIXI.Sprite),this._renderDisplay=this._display||this._rawDisplay},e.prototype._initDisplay=function(t){},e.prototype._addDisplay=function(){var t=this._armature._display;t.addChild(this._renderDisplay)},e.prototype._replaceDisplay=function(t){var e=this._armature._display,r=t;e.addChild(this._renderDisplay),e.swapChildren(this._renderDisplay,r),e.removeChild(r)},e.prototype._removeDisplay=function(){this._renderDisplay.parent.removeChild(this._renderDisplay)},e.prototype._disposeDisplay=function(t){t.destroy()},e.prototype._updateVisible=function(){this._renderDisplay.visible=this._parent.visible},e.prototype._updateBlendMode=function(){if(this._blendMode<e.BLEND_MODE_LIST.length){var t=e.BLEND_MODE_LIST[this._blendMode];t>0&&this._renderDisplay instanceof PIXI.Sprite&&(this._renderDisplay.blendMode=t)}},e.prototype._updateColor=function(){this._renderDisplay.alpha=this._colorTransform.alphaMultiplier},e.prototype._updateFilters=function(){},e.prototype._updateFrame=function(){var t=this._renderDisplay;if(this._display&&this._displayIndex>=0){var e=this._displayIndex<this._displayDataSet.displays.length?this._displayDataSet.displays[this._displayIndex]:null,r=this._displayIndex<this._replacedDisplayDataSet.length?this._replacedDisplayDataSet[this._displayIndex]:null,i=r||e,a=i.texture;if(a){var n=a.parent.texture;if(!a.texture&&n){var s=new PIXI.Rectangle(0,0,a.region.width,a.region.height);a.texture=new PIXI.Texture(n,null,a.region,s,a.rotated)}var o=this._armature._replacedTexture||a.texture;if(this._meshData&&this._display==this._meshDisplay){var l=this._meshDisplay;l.uvs=new Float32Array(this._meshData.uvs),l.vertices=new Float32Array(this._meshData.vertices),l.indices=new Uint16Array(this._meshData.vertexIndices);for(var u=0,h=l.uvs.length;u<h;u+=2){var p=l.uvs[u],_=l.uvs[u+1];l.uvs[u]=(a.region.x+p*a.region.width)/n.width,l.uvs[u+1]=(a.region.y+_*a.region.height)/n.height}this._pivotX=0,this._pivotY=0,l.texture=o,l.dirty=!0,this._meshData.skinned&&l.setTransform(0,0,1,1,0,0,0,0,0)}else{var d=a.frame||a.region,c=d.width,y=d.height;a.rotated&&(c=d.height,y=d.width),this._pivotX=i.pivot.x,this._pivotY=i.pivot.y,i.isRelativePivot&&(this._pivotX=c*this._pivotX,this._pivotY=y*this._pivotY),a.frame&&(this._pivotX+=a.frame.x,this._pivotY+=a.frame.y),e&&e!=i&&(this._pivotX+=e.transform.x-i.transform.x,this._pivotY+=e.transform.y-i.transform.y),t.texture=o,t.pivot.set(this._pivotX,this._pivotY)}return void this._updateVisible()}}this._pivotX=0,this._pivotY=0,t.visible=!1,t.texture=null,t.pivot.set(0,0),t.x=this.origin.x,t.y=this.origin.y},e.prototype._updateMesh=function(){var t=this._meshDisplay,e=this._ffdVertices.length>0;if(this._meshData.skinned)for(var r=0,i=0,a=this._meshData.vertices.length;r<a;r+=2){for(var n=r/2,s=this._meshData.boneIndices[n],o=this._meshData.boneVertices[n],l=this._meshData.weights[n],u=0,h=0,p=0,_=s.length;p<_;++p){var d=this._meshBones[s[p]],c=d.globalTransformMatrix,y=l[p],f=0,D=0;e?(f=o[2*p]+this._ffdVertices[i],D=o[2*p+1]+this._ffdVertices[i+1]):(f=o[2*p],D=o[2*p+1]),u+=(c.a*f+c.c*D+c.tx)*y,h+=(c.b*f+c.d*D+c.ty)*y,i+=2}t.vertices[r]=u,t.vertices[r+1]=h}else if(e)for(var v=this._meshData.vertices,r=0,a=this._meshData.vertices.length;r<a;r+=2){var u=v[r]+this._ffdVertices[r],h=v[r+1]+this._ffdVertices[r+1];t.vertices[r]=u,t.vertices[r+1]=h}},e.prototype._updateTransform=function(){this._renderDisplay.setTransform(this.global.x,this.global.y,this.global.scaleX,this.global.scaleY,this.global.skewY,0,0,this._pivotX,this._pivotY)},e.BLEND_MODE_LIST=[PIXI.BLEND_MODES.NORMAL,PIXI.BLEND_MODES.ADD,-1,PIXI.BLEND_MODES.DARKEN,PIXI.BLEND_MODES.DIFFERENCE,-1,PIXI.BLEND_MODES.HARD_LIGHT,-1,-1,PIXI.BLEND_MODES.LIGHTEN,PIXI.BLEND_MODES.MULTIPLY,PIXI.BLEND_MODES.OVERLAY,PIXI.BLEND_MODES.SCREEN,-1],e}(t.Slot);t.PixiSlot=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){e.call(this)}return __extends(i,e),i.toString=function(){return"[class dragonBones.PixiTextureAtlasData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.texture&&(this.texture=null)},i.prototype.generateTextureData=function(){return t.BaseObject.borrowObject(r)},i}(t.TextureAtlasData);t.PixiTextureAtlasData=e;var r=function(t){function e(){t.call(this)}return __extends(e,t),e.toString=function(){return"[class dragonBones.PixiTextureData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.texture&&(this.texture.destroy(!1),this.texture=null)},e}(t.TextureData);t.PixiTextureData=r}(dragonBones||(dragonBones={}));